CREATE TABLE `student` (
  `srn` varchar(20) NOT NULL,
  `student_name` varchar(100) NOT NULL,
  `class` varchar(5) NOT NULL,
  `section` varchar(5) NOT NULL,
  `roll_no` varchar(10) NOT NULL,
  `phone` varchar(10) NOT NULL,
  `address` varchar(1000) NOT NULL,
  `createdOn` date DEFAULT NULL,
  PRIMARY KEY (`srn`),
  UNIQUE KEY `unique_roll_no_class_section` (`class`, `section`, `roll_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `book` (
  `book_id` int NOT NULL AUTO_INCREMENT,
  `isbn` varchar(13) NOT NULL,
  `title` varchar(255) NOT NULL,
  `publication` varchar(255) NOT NULL,
  `author_name` varchar(255) NOT NULL,
  `price` int NOT NULL,
  `edition` int NOT NULL,
  `quantity` int NOT NULL DEFAULT '1',
  `isCheckedOut` int DEFAULT NULL,
  `srn` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`book_id`),
  KEY `fk_student_srn` (`srn`),
  CONSTRAINT `fk_student_srn` FOREIGN KEY (`srn`) REFERENCES `student` (`srn`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci AUTO_INCREMENT=1001;

CREATE TABLE `borrower_book_detail` (
  `srn` int NOT NULL,
  `student_name` varchar(255) NOT NULL,
  `class` int NOT NULL,
  `section` varchar(10) NOT NULL,
  `book_id` int NOT NULL,
  `isbn` varchar(13) NOT NULL,
  `title` varchar(255) NOT NULL,
  `author_name` varchar(255) NOT NULL,
  `issued_at` date NOT NULL,
  `end_date` date NOT NULL,
  `fine` int DEFAULT '0',
  `remark` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`srn`,`book_id`,`isbn`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- lms.signup definition

CREATE TABLE `signup` (
  `id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(50) NOT NULL,
  `email` varchar(100) NOT NULL,
  `password` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

drop table borrower_book_detail;
CREATE TABLE `borrower_book_detail` (
  `id` INT AUTO_INCREMENT PRIMARY KEY,
  `srn` INT  NULL,
  `student_name` VARCHAR(255) NOT NULL,
  `class` INT NOT NULL,
  `section` VARCHAR(10) NOT NULL,
  `book_id` INT  NULL,
  `isbn` VARCHAR(13)  NULL,
  `title` VARCHAR(255) NOT NULL,
  `author_name` VARCHAR(255) NOT NULL,
  `issued_at` DATE NOT NULL,
  `end_date` DATE NOT NULL,
  `fine` INT DEFAULT 0,
  `remark` VARCHAR(1000) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

ALTER TABLE borrower_book_detail
ADD COLUMN isSubmit BOOLEAN DEFAULT 0;